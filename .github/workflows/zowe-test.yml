name: zowe-test
## Notes:
# A sample zOS DBB workflow
# Global vars
env:
  # a var with a valid SSH acct on Z. With pre-gen'd and tested keys in the runner.
  DBB_Host: 'ssh laurenl@10.3.20.201'
  Zowe_RSE_Prefix: 'zowe rse issue uss'
  
  # scripts on z/OS (SSH user's Home Dir in Unix - USS). See SSH scripting Doc
  # HERE
  Echo: '"ibm/echo.sh"'
  Clone: '"ibm/git-clone.sh"'
  DBB_Build: '"ibm/dbb-build.sh"'

# "on" trigger to manually start this workflow. Can add "pull, push..." for auto trigger.
# see https://docs.github.com/en/actions/learn-github-actions/contexts
on: workflow_dispatch

jobs:
  DBB_Build_on_zOS:
    runs-on: self-hosted
    env:
      # Project related vars
      MyRepo: git@github.com:${{ github.repository }}.git
      MyWorkDir: tmp/ghActions/dbb-zappbuild-gha_run_${{ github.run_number }}
      MyWorkSpace: dbb-zappbuild-gha
      MyBranch: ${{ github.ref }}
      Zowe_RSE_WorkDir: '--cwd "/u/laurenl${{ env.MyWorkDir }}"'
        
    steps:
      - name: Echo
        run: ${{ env.Zowe_RSE_Prefix }} ${{ env.Echo }} ${{ env.Zowe_RSE_WorkDir}}
        
      - name: Clone
        run: ${{ env.Zowe_RSE_Prefix }} ${{ env.Clone }} ${{ env.MyRepo }} ${{ env.MyWorkDir }} ${{ env.MyWorkSpace }} ${{ env.MyBranch }} ${{ env.Zowe_RSE_WorkDir}}
    
#       - name: DBB_Impact_Build
#         run: ${{ env.DBB_Host }} ${{ env.DBB_Build }} ${{ env.MyWorkDir }} ${{ env.MyWorkSpace }} ghAction-poc-app --impactBuild
